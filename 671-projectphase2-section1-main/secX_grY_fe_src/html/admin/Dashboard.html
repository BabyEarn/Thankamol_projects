<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="admin/Dashboard.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="user/index.js"></script>

</head>
<body>
    <div class="dashboard-container">
        <aside class="sidebar">
            <div class="logo">
                <img class="logo_img" src="logo2.png" alt="Logo">
                GADY PADIE
            </div>
            <nav>
                <ul>
                    <li class="active"><a href="dashboard">Dashboard</a></li>
                    <li><a href="user">Users</a></li>
                    <li><a href="admin_product">Product</a></li>
                    <li><a href="administrators">Administrators</a></li>
                    <li><a href="index">Homepage</a></li>
                </ul>
                <form action="http://localhost:3030/logout" method="POST">
                    <button type="submit" class="logout_bt">LOGOUT</button>
                </form>
            </nav>
        </aside>

        <main class="main-content">
            <header>
                <h1>Dashboard</h1>
            </header>
            <div id="admin-info">
                <p>Welcome, <span id="username"></span>Adminüëã!</p>
                <br>
            </div>

            <section class="stats">
                <div class="stat-card">
                    <h2>Products Sold Today</h2>
                    <p class="stat-number">120</p>
                </div>
                
                <div class="stat-card">
                    <h2>New Customers Today</h2>
                    <p class="stat-number">45</p>
                </div>
                
                <div class="stat-card">
                    <h2>Total Revenue Today</h2>
                    <p class="stat-number">$5,670</p>
                </div>
            </section>
            <!-- chart-card -->
            <section class="charts">
                <div class="chart-card">
                    <h2>Revenue Breakdown</h2>
                    <canvas id="revenueChart" width="200" height="200"></canvas>
                </div>
                
                <div class="chart-card">
                    <h2>Website Visitors Today</h2>
                    <canvas id="visitorsChart" width="200" height="200"></canvas>
                </div>
            </section>
            <!--<button onclick="clearHistory()">Clear History</button> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏öclearHistory-->

        </main>
    </div>

    <script>
        // ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
        function generateRandomColors(count) {
            const colors = [];
            for (let i = 0; i < count; i++) {
                const randomColor = `hsl(${Math.floor(Math.random() * 360)}, 70%, 60%)`; // ‡πÉ‡∏ä‡πâ HSL ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏™‡∏µ‡∏™‡∏î‡πÉ‡∏™
                colors.push(randomColor);
            }
            return colors;
            }

        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Local Storage
        const productViews = JSON.parse(localStorage.getItem('productViews')) || {};

        // ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏£‡∏≤‡∏ü
        const labels = Object.values(productViews).map(product => product.name);
        const data = Object.values(productViews).map(product => product.views);

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å‡∏ï‡∏≤‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
        const dynamicColors = generateRandomColors(labels.length);

        // ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡∏î‡πâ‡∏ß‡∏¢ Chart.js
        const ctx = document.getElementById('revenueChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
            labels: labels, // ‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
            datasets: [{
            data: data, // ‡∏¢‡∏≠‡∏î‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏ä‡∏°
            backgroundColor: dynamicColors, // ‡πÉ‡∏ä‡πâ‡∏™‡∏µ‡πÅ‡∏ö‡∏ö‡πÑ‡∏î‡∏ô‡∏≤‡∏°‡∏¥‡∏Å
        }]
        },
        options: {
        responsive: true,
        }
    });

        // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏°‡∏à‡∏≤‡∏Å Local Storage
        const visitorsData = JSON.parse(localStorage.getItem('site_visit')) || { newVisitors: 0, returningVisitors: 0 };

        // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡πÉ‡∏ô Chart.js
        const visitorsCtx = document.getElementById('visitorsChart').getContext('2d');
        new Chart(visitorsCtx, {
            type: 'pie',
            data: {
                labels: ['New Visitors', 'Returning Visitors'],
                datasets: [{
                data: [visitorsData.newVisitors, visitorsData.returningVisitors],
                backgroundColor: ['#4BC0C0', '#FF9F40'],
                }]
            },
            options: {
            responsive: true,
                }
                });




            function clearHistory() {
                localStorage.removeItem('productViews'); // ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
                localStorage.removeItem('hasVisited'); // ‡∏•‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏¢‡∏µ‡πà‡∏¢‡∏°‡∏ä‡∏° (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)
                console.log('History cleared.');
                alert('History has been cleared.');
                location.reload(); // ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏Å‡∏£‡∏≤‡∏ü
            }
    </script>

    <script src="admin/showadmin.js"></script>

</body>
</html>
